% !Mode:: "TeX:UTF-8"

\chapter{绪论}
\section{研究工作的背景与意义}\label{sec:mean}
根据摩尔定律芯片上的晶体管数量每18个月翻一番。随着这些数量空前庞大的晶体管集成在一个芯片上，当前的多核技术很快就会发展成上百核上千核的时代\cite{borkar:DAC'07}。
已经有几十核的芯片投入生产，包括Tilera的64核处理器和intel的至强融核处理器。2012年Intel就发布了名为 Knights Corner 的至强融核协处理器，中国天河二号超级计算机就装了48000个Knights Corner芯片。
Knights Corner芯片上最多可容 61个内核。
intel下一代众核处理器 Knights Landing 可容下更多的核心。


多核和众核技术带来了极大的性能提升，但是我们不得不面对随之而来的功耗和热问题。
CMOS 技术的不断发展，功耗密度不断增长，就出现了高温热问题。不仅高的操作温度对微处理器的可靠性有负面影响，还有新的问题。
历史上，芯片和封装设计或者热建模，热工程师只需要使用芯片的总功耗，和一个温度值就能构建这个芯片的模型。
虽然这种方法在低功耗集成电路中仍然使用，但是对于高性能或者电源受限的设计中这是完全不适用的。
芯片上不断增长的非均匀功耗导致硅芯片上出现局部热点和高的温度梯度。
比如，在英特尔 90 nm 安腾处理器上，即使经过严格的热管理，局部温度仍然可以高达 $80 ^\circ$C ，同时芯片是其他部分温度相对较低（$61^\circ$C）\cite{mcgowen2006power}。
在高性能多核和众核微处理器中，这种情况更加严重。过高的高温点必然可靠性问题，性能下降。
局部高温点问题是技术发展带来的一个副作用，这给热工程师，电路设计工程师，计算机设计师带来新的挑战。
%正在增长的功耗密度和空间上的功耗差距带来的局部热问题，
%导致性能下降，散热开销大，和严重的可靠性问题。
所以找到经济和有效地方法去解决热问题同时提高多核和众核芯片的性能和可靠性仍然是一个挑战~\cite{Brooks:MICRO'07}。

针对处理器芯片热问题尤其是高性能芯片，传统的散热方式比如风扇散热冷却方法已经无法满足需求。
在微体系结构级进行动态热管理具有巨大优势，

\section{动态热管理技术的发展}\label{sec:his}

动态温度管理方法是一个提升芯片热相关性能的有效技术 \cite{Donald:ISCA'06}。在处理器在高性能水平运行时，动态温度管理通过控制处理器的运行行为，来保证处理器在安全温度以内。
动态温度管理一般有两个方法，任务迁移和动态电压频率调整（DVFS），任务迁移方法通过交换多核或者众核处理器上任务来降低芯片的最高温度 \cite{Powell:ASPLOS'04,Ge:DAC'10,Chantem:TVLSI'11,Liu:DATE'12,Ayoub:ISLPED'09,Ebi:ICCAD'09} ，
而且也可以降低多核系统的能量损耗 \cite{Cong:ISLPED'12}。
所有核都在最大速度运行，所以任务迁移方法能使处理器得到更高的性能。但是如果没有其他动态温度管理方法的话，这个可能会有平均温度太高的问题。

 动态电压频率调整（DVFS）\cite{Skadron:ISCA'03,Jayaseelan:ICCAD'09,Mutapcic:TCASI'09} 控制电压和操作频率来调整芯片的温度。
 最近，DVFS也应用于暗硅领域 \cite{Khdr:dac'15,Muthukaruppan:dac'13}，它随温度限制改变电压和频率水平。
 DVFS可以保证芯片的温度安全，但是因为频率的降低，芯片的计算性能就要下降。
 
 为了使DVFS和任务迁移更有效，控制方案通常采用基于经验的动态温度管理方法。控制器分析热模型，热传感信息等等，然后为动态温度管理技术输出引导行为，例如，DVFS应该被调整到多少频率。许多动态温度管理方法是基于传统控制方法的。但是这些方法并不太适合多核和众核热系统，因为他的复杂性。最近，模型预测方法（MPC）被引入动态温度管理。MPC利用芯片的热模型输出功率上的管理建议。因为这个方法在热行为上进行预测来得到更加有效的控制，所以mpc可以提供更有效和更精确的管理建议。对比于传统的方法，应用MPC有明显的性能提高。
 
 DVFS和任务迁移结合MPC或许可以得到这三种方法的优点。MPC有高质量的控制，任务迁移提升更高的性能，DVFS保证温度的安全。在这方面有许多研究，大都是结合这三种方法中的两种。有的研究基于经验结合任务迁移和DVFS，有的研究结合MPC和DVFS。然而，结合MPC和任务迁移要比MPC结合DVFS更难。最近有研究结合了这三种方法。但是这个方法只能应用于多核微处理器，因为在众核处理器中集成MPC和任务迁移的将引入很大的开销。
 
 \section{本论文的主要工作}\label{sec:thispaper}
在这篇文章中，针对高性能众核微处理器提出了一个新的分层动态温度管理方法。新的方法用模型预测控制来引导包含任务迁移和DVFS的管理过程。为了解决众核系统的执行集成MPC和任务迁移的可扩展性问题，新的方法将任务迁移分成两层，在第一层，相邻的核被分成一块，核功率的二部图匹配在块内执行来进行块内任务迁移。没有匹配的核收集起来做第二层的任务迁移计算。在第二层的迁移结果计算中引入改进的迭代最小割算法来提速升计算速度。新的分层方法对众核处理器来说，只需要很少的开销，而且高度可扩展既能保证高的处理器性能，又能保证温度不超过限制。