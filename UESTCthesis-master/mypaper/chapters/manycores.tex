% !Mode:: "TeX:UTF-8"

\chapter{绪论}
根据摩尔定律芯片上的晶体管数量每18个月翻一番。随着这些数量空前庞大的晶体管集成在一个芯片上，当前的多核技术很快就会发展成上百核上千核的时代\cite{borkar:DAC'07}。
已经有几十核的芯片投入生产，包括Tilera的64核处理器和intel的至强融核处理器。2012年Intel就发布了名为 Knights Corner 的至强融核协处理器，中国天河二号超级计算机就装了48000个Knights Corner芯片。
Knights Corner芯片上最多可容 61个内核。
intel下一代众核处理器 Knights Landing 可容下更多的核心。
多核和众核技术带来了极大的性能提升，但是我们不得不面对随之而来的功耗和热问题。
因为我们持续减小芯片大小和要求高功耗下的性能，增长的芯片复杂性和功耗密度提高了芯片的峰值温度，也使温度梯度更加不均衡。
上升的峰值温度缩短芯片寿命，降低芯片性能，影响可靠性也增加散热成本\cite{skadron:TACO'04}。上升的温度和静态功耗之间有正反馈的关系，有可能造成热失控。
在多核或者众核系统中，不同的应用负载或许引起核之间功耗和温度的不平衡。温度在时间和空间上的变化产生的芯片局部温度最大值叫做高温点\cite{Donald:ISCA'06}。
过多的空间上的温度差也就是热梯度增加时钟抖动降低性能和可靠性。
上升的温度需要更多的散热能力去冷却处理器，一个典型的散热风扇会消耗高达服务器 $51\%$的功耗\cite{lefurgy2003energy}\cite{ayoub2010gentlecool}。
\section{温度不被管理的不利影响}\label{sec:adverse}
\subsection{温度对系统可靠性的影响}\label{sec:reliability}
高功耗的一个最明显的结果就是上升的芯片温度，高温对芯片最严重的的后果就是损害芯片的可靠性。
下面是温度相关的半导体器件失效机理\cite{jedec2003failure}：
%\begin{itemize}
%\item 电迁移(EM)：（查的失效机理）由于传导电子和扩散金属原子之间的动量交换，金属线中例子会逐步移动，这样会导致金属线形变。甚至会引起金属线断开导致器件失效。
%\item 应力迁移（SM）：金属原子在机械应力梯度下会发生移动导致金属线变形。不同材料的热膨胀率不同会产生应力。这个也会引起金属线断开导致器件失效。
%\item 介质击穿（DB）：当介质中形成一个导电通路，电路的阴阳极短路时，介质失效。
%\end{itemize}
\begin{description}
\item[电迁移($EM$) :] ~由于传导电子和扩散金属原子之间的动量交换，金属线中离子会逐步移动，这样会导致金属线形变。它甚至会引起金属线断开导致器件失效。
\item[应力迁移（$SM$） :] ~金属原子在机械应力梯度下会发生移动导致金属线变形。不同材料的热膨胀率不同会产生应力。这个也会引起金属线断开导致器件失效。
\item[介质击穿（$DB$) :] ~当介质中形成一个导电通路，电路的阴阳极短路时，介质失效。
\end{description}

这些机理引起的失效时间（$TF$）可以被表示为下式：
\begin{equation}
TF = A \cdot e^{E_a/(k \cdot T)}
\end{equation}
其中$A$ 是一个常数，$E_a$ 活化能量（eV），$k$ 是玻尔兹曼常数（$8.62 \times 10^{-5}$ eV/K）。
这些都是正常数， $T$ 是器件的操作温度（K）。
所以， $TF$ 是温度的递减函数。
当温度上升时， $TF$ 会指数下降。这就意味着器件将极快速失效。

温度高不是系统可靠性问题的唯一原因。另外还有两个热现象即热循环和热梯度也会严重影响器件的可靠性。
热循环是操作温度的暂时波动，可能是由器件的正常功率上升或者下降引起。
另外也可能因为任务负载的变化或者设备的功耗管理策略，比如设备的部件在几种功耗模式下很频繁的切换。
热循环可以会削弱材料，引起介质裂开或者焊料疲劳等的不同失效。
热循环的失效率可以表示为：
\begin{equation}
\lambda \propto \Delta T^q
\end{equation}
其中$\Delta T$ 是热循环的幅度，$q$是热循环的频率。
温度波动越大或者越频繁，器件失效率就越大。

热梯度是整个芯片温度在空间上的不平衡。
因为现在片上系统（SoC）和多核众核芯片上负载不均衡，这样温度就会不平衡，引起大的温度梯度。
大的温度梯度最主要的影响是互连电阻不均衡，这会导致时钟偏差。这个是同步数字电路中很不希望发生的，会引起时序冲突。

\subsection{温度对静态功耗的影响}\label{sec:leakage}

温度不仅是功耗的结果，在某种程度上功耗和温度互为因果。
这是因为，静态功耗很大程度上取决于操作温度。当前静态功耗已经是系统总功耗的很明显的一部分，而且会随技术继续增长。
温度和静态功耗之间的关系已经被广泛的研究过\cite{liao2005temperature}，漏电流可以表示为：
\begin{equation}
I_{leak} = I_s \cdot A \cdot T^2e^{\frac{\alpha + \beta V_{dd}}{T}}+B
\end{equation}
其中， 对于指定的技术， $A$ 、 $B$ 、  $\alpha$ 、 $\beta$ 是温度无关的正常数。
$V_{dd}$ 是供电电压，$I_s$ 是在指定温度和供电电压下的基准漏电流。
我们可以看出温度对漏电流的影响是 $T^2e^{1/T}$ 。图~\ref{fig:leakage}是漏电流对温度的曲线。
\begin{figure}
  \centering
    \includegraphics[width=0.7\columnwidth]{fig/leakage}
  \caption{温度与漏电流的关系\cite{zhang2003hotleakage}}\label{fig:leakage}
\end{figure}

\subsection{温度对冷却系统的影响}\label{sec:cooling}

上升的温度另一个明显的坏处就是冷却成本变得更高。
为了保证芯片正常运行，芯片不得不配备成本更高的封装来散热。
对于常规散热风扇型的冷却方法，散热风扇不得不在一个更高的速度上运行来散去芯片产生的额外的热量。
这是因为散热器的散热能力是由热阻$R_{h2a}$ （R2a表示从散热器到外部环境）决定，热阻$R_{h2a}$又是由散热风扇速度决定的，如下式：
\begin{equation}\label{eq:cooling}
R_{h2a} = (h_1v_f(1-e^{\frac{h_2v_f^{h_3}+h_4}{h_1v_f}}))^{-1}
\end{equation}

在式\eqref{eq:cooling}中，$h_1$ 、 $h_2$ 、 $h_3$ 、 $h_4$是芯片的特定物理系数，$v_f$ 是散热风扇速度。
风扇功耗 $P_{fan}$正比于风扇转速的立方，即 $P_{fan} \propto v_f^3$。
这意味着高的温度不仅是风扇功耗上升，同时也降低了风扇的使用寿命。

%\section{温度不被管理的不利影响}\label{sec:adverse}























%我们已经进入众核处理器时代\cite{MaWang:APCCAS'14}.
%2012年，英特尔正式将第一代集成众核产品，代号为Knights Corner的协处理器推向市场。
%这一代产品使用P54C核心构建，片上集成61个CPU核心，实现了GPU级别的浮点运算速度。
%英特尔至强披™协处理器X100系列（代号为“Knights Corner”）是第一代英特尔®集成众核（英特尔®MIC）架构，
%它结合了许多英特尔的CPU内核在单一芯片上的。
%该生产线是针对高度并行的工作负载在各种领域，如计算物理，化学，生物和金融服务。
%Knights Corner片上集成了高达61核心。